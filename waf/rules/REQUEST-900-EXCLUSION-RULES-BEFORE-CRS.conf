# CRS가 로딩되기 “직전”에 실행될 나만의 예외/화이트리스트 설정 파일 (특정 URL/파라미터 제외, 타깃 수정 등)

# 1단계: 전역 DetectionOnly (가장 확실)
# /?file=... 테스트처럼, 전역 테스트 기간에는 전부 탐지 모드로
# 기대: 200 응답 + 로그만 쌓임
#SecRule REQUEST_URI ".*" \
#  "id:100000,phase:1,pass,nolog,ctl:ruleEngine=DetectionOnly"

# 2단계: 블로킹 룰만 제거
# 전역(테스트 기간)으로 블로킹 룰 제거
# CRS는 마지막에 “점수 임계치 초과 시 차단”을 평가하는 블로킹 룰들(949xxx/959xxx)이 있음.
# 이것들을 요청 조건에 한해 제거하면, 스코어는 쌓이지만 차단은 안 함:
# 기대: 스코어는 쌓이지만 차단은 안 됨 → 200 응답(+백엔드 응답)
#SecRule REQUEST_URI ".*" \
#  "id:100001,phase:1,pass,nolog,\
#  ctl:ruleRemoveById=949110,\
#  ctl:ruleRemoveById=959100"

# 3단계: 특정 경로/IP로 범위 축소(운영 전환 준비)
# 임계치만 높이기 (트랜잭션 변수 조정)
SecRule REQUEST_URI "^/test-only" \
  "id:100002,phase:1,pass,nolog,ctl:ruleEngine=DetectionOnly"


# 헬스체크 전면 패스
SecRule REQUEST_URI "^/health$" \
 "id:900110,phase:1,pass,log,ctl:ruleEngine=Off,msg:'health check'"
