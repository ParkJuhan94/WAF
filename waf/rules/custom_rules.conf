# 1) 특정 파라미터 SQLi 강화 (체이닝 + 성능 고려)
SecRule REQUEST_URI|ARGS_NAMES|ARGS "(?i)(select|union\s+all|sleep\()" \
    "id:100100,phase:2,pass,log,tag:'app',tag:'sqli',t:none,ctl:ruleEngine=DetectionOnly,chain"
    SecRule MATCHED_VAR "(?i)(from|where|or\s+1=1)" "t:none"

# 2) 디렉토리 트래버설 차단
SecRule ARGS|REQUEST_URI "(?:\.\./|\.\.\\)" \
    "id:100110,phase:2,block,log,severity:'CRITICAL',msg:'Path traversal detected'"

# 3) IP 레이트리밋(간단형)
SecAction "id:100120,phase:1,nolog,pass,initcol:ip=%{REMOTE_ADDR}"
SecRule IP:REQS "@gt 100" \
    "id:100121,phase:2,block,log,msg:'Too many requests from IP'"
SecAction "id:100122,phase:2,pass,log,setvar:ip.REQS=+1,expirevar:ip.REQS=60"
